# BLASTn search from read (BAM)

Test verifies
 - BLASTn search from BAM track 

**Prerequisites**:

dataset = **dm6_data**, .bam = **[agnts3.09-28.trim.dm606.realign.bam](https://ngb-oss-builds.s3.amazonaws.com/public/data/demo/ngb_demo_data/agnts3.09-28.trim.dm606.realign.bam.gz)**
.vcf = **[agnts3.09-28.trim.dm606.realign.vcf](https://ngb-oss-builds.s3.amazonaws.com/public/data/demo/ngb_demo_data/agnts3.09-28.trim.dm606.realign.vcf.gz)**

| Steps | Actions | Expected results |
| :---: | --- | --- |
| 1 | Login to NGB | |
| 2 | Go to  **Variants** panel | |
| 3 | Find Variation on Position **chr ?**|  |
| 4 | Click on Variation on Position **chr ?**| BAM and VCF tracks are opened in the Browser window |
| 5 | Go to BAM track| | 
| 6 | Click on BAM alignment **specific or any**? | Context menu is displayed <li> **BLASTn Search**  display between **BLAT Search** and **Copy info to clipboard** <li> **BLASTp Search** isn't visible in the context menu||
| 7 | Click on **BLASTn Search** in the context menu | <li> **BLAST** panel is opened first at the right side in the additional panels <li> **blastn** search tool is selected by default|
| 8 | Look at **Query Sequence** field | The corresponding sequence displays in the **Query Sequence** field|
| 9 | Fill **Task titile** field by any value (e.g. Test BAM nucleotide) in the **Task title** field | **Task titile** field is filled| 
| 10| Select **** database from the dropdown in the  **Database** field | | 
| 11| Type **** and select **** in the dropdown list of **Organism** field||
| 12|Go to **Algorithm** field| **megablast** value is displayed by default |
| 13| Expand **Additional parameters** | |
| 14| Remeber values in the fields of **Additional parameters** block| |
| 15| Click on **Search** button|  <li> Search is started <li> **History** sub-tab is opened automatically |
| 16|  Look at **History** sub-tab | <li> A new search task created  <li> New task ID is auto generated <li> Title of the certain search task (if it was specified before the search) in the **Task title** column <li> Current state is **Searching...** <li>  Date and time when the certain search was started is displayed in the **Submitted at** column <li> Duration of the certain search task displays in the **Duration** column <li> button to cancel search (conventionally shown by a cross-button) <li>  button to open the search again in the "Search" sub-tab (conventionally shown by a reverse arrow-button) |
| 17| Wait until status changed to **Done**| <li> **Current state** changed to **Done** <li> button to open the search again in the "Search" sub-tab (reverse arrow-button) displays |
| 18| Click on last search id in the **Task ID** column | <li> The corresponding results is opened in the same **History** sub-tab <li> **Blast parameters** collapsible section (collapsed by default) is displayed <li> Search results are displayed in the table of **History** sub-tab above **Blast parameters** section
| 19| Click on the first sequence ID in the **Sequence ID** column  | the form with details about all matches (alignments) of the search query to the certain sequence is opened <li> "Alignments" form is opened in the same tab ("History") |
| 20| Click on **View at track** button for the first alighnment |The pop-up for an alignment of the nucleotide sequence is appered |

