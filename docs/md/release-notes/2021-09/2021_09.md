# Release Notes. 2021-09

- [Ability to highlight variants of interest](#ability-to-highlight-variants-of-interest)
- [BLAST search](#blast-search)
- [Genes panel](#genes-panel)
- [Homologs search](#homologs-search)
- [Other](#other)
    - [FeatureCounts support](#featurecounts-support)
- [Bug fixes](#bug-fixes)

## Ability to highlight variants of interest

VCF files may include a large number of variants and it might be helpful to highlight variants of interest based on specific values of their attributes.

Now, system admin can create/edit the special JSON-file (`interest_profiles.json`) where a list of condition profiles is being described.  
Each profile in that file contains an own set of conditions based on the variant attributes. For a condition, the color is being specified.

At the GUI, any user can enable the highlight feature from the **Settings** (**VCF** tab) and select any profile from the described file:  
  ![ReleaseNotes_2021-09](images/RN_HighlightVCF_1.png)

In the variants table, if the variant is satisfy to the certain condition of the selected profile - variant row will be highlighted in that condition color:  
  ![ReleaseNotes_2021-09](images/RN_HighlightVCF_2.png)

Also at the VCF track, if the variant is satisfy to the certain condition of the selected profile - this variant will be highlighted in that condition color:  
  ![ReleaseNotes_2021-09](images/RN_HighlightVCF_3.png)

For more details see [here](../../user-guide/overview.md#highlight-variants-of-interest).

## BLAST search

Now, users have the ability to perform [BLAST](https://blast.ncbi.nlm.nih.gov/Blast.cgi) Search from the NGB.  
This allows to search nucleotide/amino acid sequences over BLAST databases and view the corresponding results.  
BLAST databases should be previously uploaded into NGB (this could be as downloaded NCBI [databases](https://github.com/ncbi/blast_plus_docs#blast-databases) or custom ones).

Ways to start setup the BLAST search:

- by the context menu at any genomic feature (except variants) in the "**Browser**" panel:  
  ![ReleaseNotes_2021-09](images/RN_Blast_1.png)
- or manually open the **BLAST** panel from the **Views** menu:  
  ![ReleaseNotes_2021-09](images/RN_Blast_2.png)

Once the BLAST panel is opened, user should specify desired parameters and click the **Search** button:  
  ![ReleaseNotes_2021-09](images/RN_Blast_3.png)

All BLAST search tasks are displayed at the **History** sub-tab of the **BLAST** panel.  
This sub-tab is being opened automatically after the search starts:  
  ![ReleaseNotes_2021-09](images/RN_Blast_4.png)

User can open any finished task by click its row and view the BLAST search results.  
BLAST search results contain **Sequences table** - aggregated results grouped by their sequences.  
This form is being opened in the same sub-tab (**History**), e.g.:  
  ![ReleaseNotes_2021-09](images/RN_Blast_5.png)

User can click any row in the **Sequence table** and the form with details about all matches (alignments) of the search query to the certain sequence will be opened.  
This form is being opened in the same sub-tab (**History**) as well, e.g.:  
  ![ReleaseNotes_2021-09](images/RN_Blast_6.png)  
  ![ReleaseNotes_2021-09](images/RN_Blast_7.png)

User can view any found match (alignment) at the separate track in the "**Browser**" panel.  
To open the visualization track, user should click the "_View at track_" link near the match in the "**Alignments info**" form:  
  ![ReleaseNotes_2021-09](images/RN_Blast_8.png)  
  ![ReleaseNotes_2021-09](images/RN_Blast_9.png)

For more details see [here](../../user-guide/overview.md#blast-panel).

## Genes panel

A new panel was added to NGB - the **Genes** panel.  
This panel displays a list of genes/transcripts/exons and other features of the current dataset (from corresponding GFF/GTF and GenBank files) in a tabular view.  
  ![ReleaseNotes_2021-09](images/RN_GeneTable_1.png)

By default in the panel, only the following columns are shown:

- _Chr_ - chromosome/sequence name
- _Name_ - feature name
- _Id_ - feature ID
- _Type_ - feature type
- _Start_ - start position of the feature on the chromosome/sequence
- _End_ - end position of the feature on the chromosome/sequence
- _Strand_ - feature strand
- _Info_ - button to open the certain feature full info

Users can display or hide extra columns - from the list appeared by click the _hamburger_ icon in the panel header:  
  ![ReleaseNotes_2021-09](images/RN_GeneTable_2.png)  
There are two types of additional columns in this list:

- mandatory feature fields from origin gene files (_Feature_, _Frame_, _Gene_, _Score_, _Source_) are shown as is
- optional feature attributes from the "**Attributes**" column of the origin gene files are shown in format `<Attribute_name> (attr)`  

Table supports sorting, pagination and the feature of the downloading the shown data to the local workstation.

To view the full feature info - user can click the corresponding button and view the info in the separate pop-up:  
  ![ReleaseNotes_2021-09](images/RN_GeneTable_3.png)

Additionally, users can modify gene/feature attributes shown in the **Genes** panel via the GUI.  
These changes will be saved in NGB and will be available to all other users, but they don't touch the original GENE files:  
  ![ReleaseNotes_2021-09](images/RN_GeneTable_4.png)  
  ![ReleaseNotes_2021-09](images/RN_GeneTable_5.png)  
User can modify (add/edit/remove) the attribute values manually for any gene/feature from the GENES panel and save changes:  
  ![ReleaseNotes_2021-09](images/RN_GeneTable_6.png)

Performed changes can be viewed in the **Genes** panel:  
  ![ReleaseNotes_2021-09](images/RN_GeneTable_7.png)

Also, the changes history (what was changed, when and by whom) can be viewed at the special tab of the feature **Info** pop-up:  
  ![ReleaseNotes_2021-09](images/RN_GeneTable_8.png)

For more details see [here](../../user-guide/overview.md#genes-panel).

## Homologs search

Now, users can search for the homologous genes (similar genes in other species).  
The search is being performed in the inner copy of [`NCBI Homologene`](https://www.ncbi.nlm.nih.gov/homologene/) database or in uploaded custom databases.

To start the search of homologous genes user should click the gene of interest (at any GENE track or at the **Genes** panel) and select the item "**Show similar genes**" in the context menu, e.g.:  
  ![ReleaseNotes_2021-09](images/RN_Homologs_1.png)

After, the search in the inner copy of NCBI Homologene database will be performed using the gene name and the current species.  
**Homologs** panel with aggregated search results will be opened automatically:  
  ![ReleaseNotes_2021-09](images/RN_Homologs_2.png)

This panel contains two sub-tabs:

- "**Homologene**" (_opened by default_) - for displaying search results of gene homologs from the NCBI Homologene database
- "**Orthologs & paralogs**" - for displaying search results of gene orthologs and paralogs from the corresponding NCBI Database (`NCBI Orthologs`) and/or inner NGB databases

Click any row in the **Homologene** sub-tab to open details of the certain Homologene record:  
  ![ReleaseNotes_2021-09](images/RN_Homologs_3.png)  
  ![ReleaseNotes_2021-09](images/RN_Homologs_4.png)

Click any domain in the details table and a tooltip will appear with a full "legend" of the corresponding gene domains:  
  ![ReleaseNotes_2021-09](images/RN_Homologs_5.png)

You can also open the "**Orthologs & paralogs**" sub-tab to view the search results over orthologs and paralogs NGB databases (NCBI Orthologs or custom ones), e.g.:  
  ![ReleaseNotes_2021-09](images/RN_Homologs_6.png)

In this sub-tab, you also can click the row to view details:  
  ![ReleaseNotes_2021-09](images/RN_Homologs_7.png)

For more details see [here](../../user-guide/overview.md#homologs-panel).

***

## Other

### FeatureCounts support

Now, NGB supports [FeatureCounts](http://bioinf.wehi.edu.au/featureCounts/) file format registration and displaying.

FeatureCounts file is being parsed into GFF format during the registration.

FeatureCounts tracks are being displayed in the way similar to GENE tracks, but here only genes and exons are displayed:  
  ![ReleaseNotes_2021-09](images/RN_FeatureCounts_1.png)

Also, these files can be displayed in "_Bar Graph_" mode - as histograms:  
  ![ReleaseNotes_2021-09](images/RN_FeatureCounts_2.png)

For displayed bars, color scheme and scale modes can be configured:  
  ![ReleaseNotes_2021-09](images/RN_FeatureCounts_3.png)

In case of several source inputs (several alignment files) for the FeatureCounts file, at the FeatureCounts track several sub-tracks are shown - a single sub-track for each source SAM/BAM file:  
  ![ReleaseNotes_2021-09](images/RN_FeatureCounts_4.png)

For more details see [here](../../user-guide/tracks-featurecounts.md).

***

## Bug fixes

### ...
